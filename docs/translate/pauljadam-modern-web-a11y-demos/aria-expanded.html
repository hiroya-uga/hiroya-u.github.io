<!DOCTYPE html>
<html lang="ja">
<head>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-60524027-4"></script>
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());

gtag('config', 'UA-60524027-4');
</script>
<meta charset="UTF-8">
<title>aria-expanded属性の状態をスクリーンリーダに伝える</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<style>
@font-face {
  font-family: "Yu Gothic";
  font-weight: 100;

  src: local("Yu Gothic Medium");
}
@font-face {
  font-family: "Yu Gothic";
  font-weight: 200;

  src: local("Yu Gothic Medium");
}
@font-face {
  font-family: "Yu Gothic";
  font-weight: 300;

  src: local("Yu Gothic Medium");
}
@font-face {
  font-family: "Yu Gothic";
  font-weight: 400;

  src: local("Yu Gothic Medium");
}
@font-face {
  font-family: "Yu Gothic";
  font-weight: bold;

  src: local("Yu Gothic Bold");
}

*:focus {
  outline: 3px solid #27b;
}

html {
  font-family: -apple-system, BlinkMacSystemFont, "Helvetica Neue", Helvetica,
  YuGothic, "Yu Gothic",
  "Hiragino Sans", "Hiragino Kaku Gothic ProN", "Hiragino Kaku Gothic Pro",
  Meiryo,
  sans-serif,
  "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji";
  font-size: 62.5%;
}
body {
  font-family: -apple-system, BlinkMacSystemFont, "Helvetica Neue", "Yu Gothic", YuGothic, Verdana, Meiryo, "M+ 1p", sans-serif;
  font-size: 1.6rem;
  font-weight: 500;
  color: #333;
  max-width: 1280px;
  margin: 0 auto !important;
  padding: 10px 15px;
}
h1 {
  font-size: 2rem;
}
h2 {
  font-size: 1.8rem;
  margin-top: 100px;
}
h1 + h2 {
  margin-top: 0;
}
em {
  font-style: normal;
  font-weight: bold;
}
hr {
  border: 1px solid #ccc;
  border-width: 0 0 1px;
  display: block;
}
p ,
ol ,
ul {
  line-height: 1.9;
  letter-spacing: 1.3px;
  box-sizing: border-box;
  max-width: 40em;
}
strong {
  color: #c11;
}
input,
select,
textarea {
  font-size: 1.6rem;
}
textarea,
select,
input:not([type="range"]):not([type="radio"]):not([type="checkbox"]):not([type="color"]) {
  padding: 6px;
}
a {
  letter-spacing: 0;
}
img {
  max-width: 100%;
  height: auto;
}
button {
  font-size: inherit;
}
code ,
kbd {
  font-family: inherit;
  font-size: 100%;
}
kbd {
  font-size: 95%;
  line-height: 1;
  position: relative;
  top: 0;
  display: inline-block;
  margin: 0 3px;
  padding: 6px 6px 4px;
  border: 1px solid #aaa;
  border-radius: 6px;
}
kbd kbd {
  top: 0;
  margin: 0 6px;
  padding: 0;
  border: 0;
}
footer {
  font-size: 1.2rem;
  margin-top: 30vh;
  padding-top: 10px;
  border-top: 1px solid #ddd;
}
footer h2 {
  font-size: 1.4rem;
}
table {
  border-collapse: collapse;
  border-spacing: 0;
}
td,
th {
  border: 1px solid #333;
  padding: 10px;
}
</style>

</head>

<body>
<header>
<p><a href="./">DEMO一覧に戻る</a> | <a href="http://pauljadam.com" lang="en-US">PaulJAdam.comでさらに詳しく</a></p>
</header>

<main>
<h1>aria-expanded属性の状態をスクリーンリーダに伝える</h1>
<h2>aria-expandedを持つリンク</h2>
<p><a href="#" aria-expanded="true" aria-controls="dynamic-container"><span aria-hidden="true">[-]</span>詳細</a></p>
<div id="dynamic-container">
<p>詳細テキスト詳細テキスト詳細テキスト詳細テキスト</p>
</div>
<script>
var dynCtrlr = document.querySelector('[aria-controls=dynamic-container]');
dynCtrlr.addEventListener("click", expandCollapseContainer);
function expandCollapseContainer(event) {
	event.preventDefault();
	dynCtrlr = document.querySelector('[aria-controls=dynamic-container]');
	var dynCtnr = document.querySelector('#dynamic-container');
	var isExpanded = dynCtrlr.getAttribute('aria-expanded');
	if (isExpanded == "true") {
		dynCtnr.style.visibility = "hidden";
		dynCtrlr.innerHTML = "<span aria-hidden=true>[+]</span> 詳細";
		dynCtrlr.setAttribute('aria-expanded','false');
	} else {
		dynCtnr.style.visibility = "visible";
		dynCtrlr.innerHTML = "<span aria-hidden=true>[-]</span> 詳細";
		dynCtrlr.setAttribute('aria-expanded','true');
	}
}
</script>
<h2>aria-expandedを持つボタン</h2>
<p><button aria-expanded="true" aria-controls="dynamic-button-container"><span aria-hidden="true">[-]</span>詳細</button></p>
<div id="dynamic-button-container">
<p>詳細テキスト詳細テキスト詳細テキスト詳細テキスト</p>
</div>
<script>
var dynBtnCtrlr = document.querySelector('[aria-controls=dynamic-button-container]');
dynBtnCtrlr.addEventListener("click", expandCollapseBtnContainer);
function expandCollapseBtnContainer() {
	dynBtnCtrlr = document.querySelector('[aria-controls=dynamic-button-container]');
	var dynBtnCtnr = document.querySelector('#dynamic-button-container');
	var isExpanded = dynBtnCtrlr.getAttribute('aria-expanded');
	if (isExpanded == "true") {
		dynBtnCtnr.style.visibility = "hidden";
		dynBtnCtrlr.innerHTML = "<span aria-hidden=true>[+]</span> 詳細";
		dynBtnCtrlr.setAttribute('aria-expanded','false');
	} else {
		dynBtnCtnr.style.visibility = "visible";
		dynBtnCtrlr.innerHTML = "<span aria-hidden=true>[-]</span> 詳細";
		dynBtnCtrlr.setAttribute('aria-expanded','true');
	}
}
</script>
<h2>aria-expandedを持つタブ</h2>
<p>
<div id="tablist">
<span>タブ1</span> <span>タブ2</span> <span>タブ3</span>
</div>
<div class="tab-panel" id="tp1">
<p>タブパネル 1</p>
</div>
<div class="tab-panel" id="tp2">
<p>タブパネル 2</p>
</div>
<div class="tab-panel" id="tp3">
<p>タブパネル 3</p>
</div>
<script>
(function () {
    'use strict';

    var tablist = document.getElementById('tablist');
    var tabPanel = document.getElementsByClassName('tab-panel');

    tablist.setAttribute('role', 'tablist')

    Array.prototype.forEach.call(tablist.children, function (tab, idx) {
        tab.id = 'tab-' + idx;
        tab.setAttribute('role', 'tab');
        tab.setAttribute('aria-controls', tabPanel[idx].id);

        if (idx === 1) {
            tab.tabIndex = 0;
            tab.setAttribute('aria-expanded', 'true');

            return;
        }

        tab.tabIndex = -1;
        tab.setAttribute('aria-expanded', 'false');
    });

    Array.prototype.forEach.call(tabPanel, function (panel, idx) {
        panel.setAttribute('role', 'tabpanel');
        panel.setAttribute('aria-labelledby', tablist.children[idx].id);
    });
}());
var tabs = document.querySelectorAll('[role=tab]');
for (i = 0; i < tabs.length; i++) { tabs[i].addEventListener("click", showTabPanel); tabs[i].addEventListener("keydown", showTabPanelKbrd); }
function showTabPanel(el) {
	var tabs2 = document.querySelectorAll('[role=tab]');
	for (i = 0; i < tabs2.length; i++) { tabs2[i].innerText = "タブ" + (i + 1); tabs2[i].setAttribute('aria-expanded','false'); tabs2[i].tabIndex = -1;tabs2[i].setAttribute('aria-selected','false');}
    el.target.tabIndex = 0;
	el.target.innerHTML = "<span aria-hidden=true>[</span>" + el.target.textContent.trim() + "<span aria-hidden=true>]</span>";
	el.target.setAttribute('aria-expanded', 'true');
	el.target.setAttribute('aria-selected', 'true');
	var tabPanelToOpen = el.target.getAttribute('aria-controls');
	var tabPanels = document.querySelectorAll('[role=tabpanel]');
	for (i = 0; i < tabPanels.length; i++) { tabPanels[i].style.display = "none"; }
	document.getElementById(tabPanelToOpen).style.display = "block";
}
function showTabPanelKbrd(e) {
    var key = e.key.replace('Arrow', '');

    if (
        e.keyCode == "13" ||
        e.keyCode == "32"
    ) {
        showTabPanel(e);
    } else if (
        key === 'Up' ||
        key === 'Left'
    ) {
        e.preventDefault();

        if (this.previousElementSibling) {
            this.previousElementSibling.click();
            this.previousElementSibling.focus();
        }
    } else if (
        key === 'Down' ||
        key === 'Right'
    ) {
        e.preventDefault();

        if (this.nextElementSibling) {
            this.nextElementSibling.click();
            this.nextElementSibling.focus();
        }
    }
}
tabs[1].click();
</script>
</main>

<footer>
<h2>原文</h2>

<p><a href="http://www.pauljadam.com/demos/">PaulJAdam's Modern Web Accessibility Demos</a></p>
</footer>
</body>
</html>
